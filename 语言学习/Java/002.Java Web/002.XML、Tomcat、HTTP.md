# XML

> XML 是 EXtensible Markup Language 的缩写，翻译过来就是可扩展标记语言。所以很明显，XML 和 HTML 一样都是标记语言，也就是说它们的基本语法都是标签。

- 可扩展三个字表面上的意思是 XML 允许自定义格式。但这不代表你可以随便写。
- 在 XML 基本语法规范的基础上，你使用的那些第三方应用程序、框架会通过 XML 约束的方式强制规定配置文件中可以写什么和怎么写
- XML 基本语法这个知识点的定位是：我们不需要从零开始，从头到尾的一行一行编写 XML 文档，而是在第三方应用程序、框架已提供的配置文件的基础上修改。要改成什么样取决于你的需求，而怎么改取决 XML 基本语法和具体的 XML 约束。

## 常见配置文件类型

1. properties，例如 druid 连接池就是使用 properties 文件作为配置文件
2. XML，例如 Tomcat 就是使用 XML 文件作为配置文件
3. YAML，例如 SpringBoot 就是使用 YAML 作为配置文件
4. JSON，通常用来做文件传输，也可以用来做前端或者移动端的配置文件
5. 等等...

### properties 配置文件

示例：

```properties
atguigu.jdbc.url=jdbc:mysql://localhost:3306/atguigu
atguigu.jdbc.driver=com.mysql.cj.jdbc.Driver
atguigu.jdbc.username=root
atguigu.jdbc.password=root
```

语法规范：

- 由键值对组成
- 键和值之间的符号是等号
- 每一行都必须顶格写，前面不能有空格之类的其他符号

### XML 配置文件

示例：

```xml
<?xml version="1.0" encoding="UTF-8"?>
<students>
    <student>
        <name>张三</name>
        <age>18</age>
    </student>
    <student>
        <name>李四</name>
        <age>20</age>
    </student>
</students>
```

XML 的基本语法：

- XML 的基本语法和 HTML 的基本语法简直如出一辙。其实这不是偶然的，XML 基本语法 + HTML 约束 = HTML 语法。在逻辑上 HTML 确实是 XML 的子集。
- XML 文档声明 这部分基本上就是固定格式，要注意的是文档声明一定要从第一行第一列开始写
	- `<?xml version="1.0" encoding="UTF-8"?>`
- 根标签：根标签有且只能有一个
- 标签关闭
    - 双标签：开始标签和结束标签必须成对出现。
    - 单标签：单标签在标签内关闭。
- 标签嵌套：可以嵌套，但是不能交叉嵌套
- 注释不能嵌套
- 标签名、属性名建议使用小写字母
- 属性
    - 属性必须有值
    - 属性值必须加引号，单双都行

XML 的约束：

将来我们主要就是根据 XML 约束中的规定来编写 XML 配置文件，而且会在我们编写 XML 的时候根据约束来提示我们编写, 而 XML 约束主要包括 DTD 和 Schema 两种。

- DTD
- Schema

Schema 约束要求我们一个 XML 文档中，所有标签，所有属性都必须在约束中有明确的定义。

下面我们以 web.xml 的约束声明为例来做个说明：

```xml
<web-app xmlns="http://xmlns.jcp.org/xml/ns/javaee"
         xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
         xsi:schemaLocation="http://xmlns.jcp.org/xml/ns/javaee http://xmlns.jcp.org/xml/ns/javaee/web-app_4_0.xsd"
         version="4.0">
```

## DOM4J 进行 XML 解析

### DOM4J 的使用步骤

1. 导入 jar 包：dom4j.jar
2. 创建解析器对象（SAXReader）
3. 解析 XML 获得 Document 对象
4. 获取根节点 RootElement
5. 获取根节点下的子节点

### DOM4J 的 API 介绍

```java
// 1. 创建 SAXReader 对象
SAXReader saxReader = new SAXReader();

// 2. 解析 XML 获取 Document 对象: 需要传入要解析的 XML 文件的字节输入流
Document document = reader.read(inputStream);

// 3. 获取文档的根标签
Element rootElement = documen.getRootElement()

// 4. 获取标签的子标签
// 获取所有子标签
List<Element> sonElementList = rootElement.elements();
// 获取指定标签名的子标签
List<Element> sonElementList = rootElement.elements("标签名");

// 5. 获取标签体内的文本
String text = element.getText();

// 6. 获取标签的某个属性的值
String value = element.attributeValue("属性名");
```

# Tomcat 10

## Web 服务器

Web 服务器通常由硬件和软件共同构成。

- 硬件：电脑，提供服务供其它客户电脑访问
- 软件：电脑上安装的服务器软件，安装后能提供服务给网络中的其他计算机，将本地文件映射成一个虚拟的 URL 地址供网络中的其他人访问。

![[1681441674967.png]]

常见的 JavaWeb 服务器：

- Tomcat（Apache）：当前应用最广的 JavaWeb 服务器
- Jetty：更轻量级、更灵活的 servlet 容器
- JBoss（Redhat 红帽）：支持 JavaEE，应用比较广 EJB 容器 –> SSH 轻量级的框架代替
- GlassFish（Orcale）：Oracle 开发 JavaWeb 服务器，应用不是很广
- Resin（Caucho）：支持 JavaEE，应用越来越广
- Weblogic（Orcale）：要钱的！支持 JavaEE，适合大型项目
- Websphere（IBM）：要钱的！支持 JavaEE，适合大型项目

## Tomcat 服务器

### 简介

![[1681452377469.png]]

Tomcat 是 Apache 软件基金会（Apache Software Foundation）的 Jakarta 项目中的一个核心项目，由 Apache、Sun 和其他一些公司及个人共同开发而成。最新的 Servlet 和 JSP 规范总是能在 Tomcat 中得到体现，因为 Tomcat 技术先进、性能稳定，而且免费，因而深受 Java 爱好者的喜爱并得到了部分软件开发商的认可，成为目前比较流行的 Web 应用服务器。

### 安装

版本：

企业用的比较广泛的是 8.0 和 9.0，目前比较新正式发布版本是 Tomcat 10.0，Tomcat 11 仍然处于测试阶段。

JavaEE 版本和 Servlet 版本号对应关系：[Jakarta EE Releases](https://jakarta.ee/release/)

|Servlet Version |EE Version|
|---|---|
|6.1|Jakarta EE ?|
|6.0|Jakarta EE 10|
|5.0|Jakarta EE 9/9.1|
|4.0|JAVA EE 8|
|3.1|JAVA EE 7|
|3.1|JAVA EE 7|
|3.0|JAVAEE 6|

Tomcat 版本和 Servlet 版本之间的对应关系：

|Servlet Version |Tomcat Version |JDK Version |
|---|---|---|
|6.1|11.0.x|17 and later|
|6.0|10.1.x|11 and later|
|5.0|10.0.x (superseded)|8 and later|
|4.0|9.0.x|8 and later|
|3.1|8.5.x|7 and later|
|3.1|8.0.x (superseded)|7 and later|
|3.0|7.0.x (archived)|6 and later (7 and later for WebSocket)|

下载：

- Tomcat 官方网站：[ http://tomcat.apache.org/ ]( http://tomcat.apache.org/ " http://tomcat.apache.org/" )
- 安装版：需要安装
- 解压版：直接解压缩使用

![[1681442513261.png]]

安装：

1. 正确安装 JDK 并配置 JAVA_HOME
2. 解压 tomcat 到非中文无空格目录
3. 点击 `bin/startup.bat` 启动
4. 打开浏览器输入 [http://localhost:8080](http://localhost:8080) 访问测试 ![[1681443038911.png]]
5. 直接关闭窗口或者运行 `bin/shutdown.bat` 关闭 tomcat

处理 DOS 窗口日志中文乱码问题：修改 `conf/logging.properties`，将所有的 UTF-8 修改为 GBK

![[1681443202115.png]]

更推荐修改 DOS 字符集

## Tomcat 目录及测试

`C:\Program4java\apache-tomcat-10.1.7` 这个目录下直接包含 Tomcat 的 `bin` 目录，`conf` 目录等，我们称之为 Tomcat 的安装目录或根目录。

- `bin`：该目录下存放的是二进制可执行文件
	- 如果是安装版，那么这个目录下会有两个 `exe` 文件：`tomcat10.exe`、`tomcat10w.exe`，前者是在控制台下启动 Tomcat，后者是弹出 GUI 窗口启动 Tomcat
	- 如果是解压版，那么会有 `startup.bat` 和 `shutdown.bat` 文件，前者用来启动 Tomcat，但需要先配置 `JAVA_HOME` 环境变量才能启动，后者用来停止 Tomcat
- `conf`：这是一个非常非常重要的目录，这个目录下有四个最为重要的文件：
    - ==`server.xml`==：配置整个服务器信息。例如修改端口号。默认 Tomcat HTTP 请求的端口号是 8080
    - `tomcat-users.xml`：存储 Tomcat 用户的文件，这里保存的是 Tomcat 的用户名及密码，以及用户的角色信息。可以按着该文件中的注释信息添加 Tomcat 用户，然后就可以在 Tomcat 主页中进入 Tomcat Manager 页面了
    - `web.xml`：部署描述符文件，这个文件中注册了很多 MIME 类型，即文档类型。这些 MIME 类型是客户端与服务器之间说明文档类型的，如用户请求一个 html 网页，那么服务器还会告诉客户端浏览器响应的文档是 `text/html` 类型的，这就是一个 MIME 类型。客户端浏览器通过这个 MIME 类型就知道如何处理它了。当然是在浏览器中显示这个 html 文件了。但如果服务器响应的是一个 `exe` 文件，那么浏览器就不可能显示它，而是应该弹出下载窗口才对。MIME 就是用来说明文档的内容是什么类型的！
    - `context.xml`：对所有应用的统一配置，通常我们不会去配置它。
- `lib`：Tomcat 的类库，里面是一大堆 jar 文件。如果需要添加 Tomcat 依赖的 jar 文件，可以把它放到这个目录中，当然也可以把应用依赖的 jar 文件放到这个目录中，这个目录中的 jar 所有项目都可以共享之，但这样你的应用放到其他 Tomcat 下时就不能再共享这个目录下的 jar 包了，所以建议只把 Tomcat 需要的 jar 包放到这个目录下
- `logs`：这个目录中都是日志文件，记录了 Tomcat 启动和关闭的信息，如果启动 Tomcat 时有错误，那么异常也会记录在日志文件中。
- `temp`：存放 Tomcat 的临时文件，这个目录下的东西可以在停止 Tomcat 后删除
- ==`webapps`==：存放 web 项目的目录，其中每个文件夹都是一个项目；如果这个目录下已经存在了目录，那么都是 tomcat 自带的项目。
	- 其中 ROOT 是一个特殊的项目，在地址栏中访问：[http://127.0.0.1:8080](http://127.0.0.1:8080)，没有给出项目目录时，对应的就是 ROOT 项目
	- [http://localhost:8080/examples](http://localhost:8080/examples)，进入示例项目。其中“examples”就是项目名，即文件夹的名字
- `work`：运行时生成的文件，最终运行的文件都在这里。通过 webapps 中的项目生成的！可以把这个目录下的内容删除，再次运行时会生再次生成 `work` 目录。当客户端用户访问一个 JSP 文件时，Tomcat 会通过 JSP 生成 Java 文件，然后再编译 Java 文件生成 class 文件，生成的 java 和 class 文件都会存放到这个目录下
- `LICENSE`：许可证
- `NOTICE`：说明文件
